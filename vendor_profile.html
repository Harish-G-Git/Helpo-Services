<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vendor Profile - Helpo Services</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .navbar {
      background-color: #4B0082;
      color: white;
      padding: 0.8rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .navbar h1 {
      margin: 0;
      font-size: 1.5rem;
      color: white;
    }
    .nav-actions a {
      margin-left: 1rem;
      color: white;
      text-decoration: none;
      font-weight: 500;
      background-color: #6A0DAD;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 14px;
      transition: background-color 0.3s;
    }
    .nav-actions a:hover {
      background-color: #500c8e;
    }
    textarea[disabled], input[disabled] {
      background-color: #f8f9fa;
    }
  </style>
</head>
<body>

<!-- Header -->
<header class="navbar">
  <h1>Helpo Services</h1>
  <div class="nav-actions">
    <a href="/">🏠 Home</a>
    <a href="/vendor/dashboard">📊 Dashboard</a>
    <a href="/vendor/leads">📥 My Leads</a>
    <a href="/vendor/logout" class="text-danger">🚪 Logout</a>
  </div>
</header>

<!-- Profile Content -->
<div class="container mt-4">
  <h3>👤 Your Business Profile</h3>
  <form method="POST" enctype="multipart/form-data" id="profileForm">

    <!-- Business Details -->
    <div class="row">
      <div class="col-md-6 mb-3">
        <label>Business Name</label>
        <input type="text" class="form-control" name="business_name" value="{{ vendor['business_name'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Category</label>
        <input type="text" class="form-control" name="category" value="{{ vendor['category'] }}" disabled>
      </div>
    </div>

    <!-- Address -->
    <h5 class="mt-4">📍 Address</h5>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label>Plot / Bldg / Floor</label>
        <input type="text" class="form-control" name="plot_info" value="{{ vendor['plot_info'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Building / Market</label>
        <input type="text" class="form-control" name="building_info" value="{{ vendor['building_info'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Street / Road</label>
        <input type="text" class="form-control" name="street" value="{{ vendor['street'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Landmark</label>
        <input type="text" class="form-control" name="landmark" value="{{ vendor['landmark'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Area</label>
        <input type="text" class="form-control" name="area" value="{{ vendor['area'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>City</label>
        <input type="text" class="form-control" name="city" value="{{ vendor['city'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>State</label>
        <input type="text" class="form-control" name="state" value="{{ vendor['state'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Pincode</label>
        <input type="text" class="form-control" name="pincode" value="{{ vendor['pincode'] }}" disabled>
      </div>
    </div>

    <!-- Contact -->
    <h5 class="mt-4">📞 Contact Info</h5>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label>Phone</label>
        <input type="text" class="form-control" name="phone" value="{{ vendor['phone'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Email</label>
        <input type="email" class="form-control" name="email" value="{{ vendor['email'] }}" disabled>
      </div>
    </div>

    <!-- Auth -->
    <h5 class="mt-4">🔒 Account Info</h5>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label>Password</label>
        <input type="password" class="form-control" name="password" value="{{ vendor['password'] }}" disabled>
      </div>
      <div class="col-md-6 mb-3">
        <label>Confirm Password</label>
        <input type="password" class="form-control" name="confirm_password" value="{{ vendor['confirm_password'] }}" disabled>
      </div>
    </div>

    <!-- Description & Photos -->
    <h5 class="mt-4">📝 Business Info</h5>
    <div class="mb-3">
      <label>Description</label>
      <textarea class="form-control" name="description" rows="3" disabled>{{ vendor['description'] }}</textarea>
    </div>

    <div class="mb-3">
      <label>Service Hours</label>
      <input type="text" class="form-control" name="service_hours" value="{{ vendor['service_hours'] }}" disabled>
    </div>

    <div class="mb-3">
      <label>Uploaded Photos</label><br>
      {% if vendor.photos %}
        <div class="mb-2 d-flex flex-wrap">
  {% for photo_url in vendor.photos.split(',') %}
    <div class="me-3 mb-3 text-center">
      <img src="{{ url_for('static', filename='uploads/' ~ photo_url) }}" alt="Photo" class="img-thumbnail" width="100">
      <div class="form-check mt-1">
        <input class="form-check-input" type="checkbox" name="remove_photos" value="{{ photo_url }}" id="remove_{{ loop.index }}">
        <label class="form-check-label small text-danger" for="remove_{{ loop.index }}">
          Remove
        </label>
      </div>
    </div>
  {% endfor %}
</div>

      {% else %}
        <p class="text-muted">No photos uploaded.</p>
      {% endif %}
    </div>

    <div class="mb-3 d-none" id="photoInput">
      <label>Upload New Photos</label>
      <input type="file" name="photos" class="form-control" accept="image/*" multiple>
      <div id="photoPreview" class="d-flex gap-2 flex-wrap mt-2"></div>
    </div>

    <!-- Buttons -->
    <div class="mt-4">
      <button type="button" class="btn btn-warning" id="editBtn">✏️ Edit</button>
      <button type="submit" class="btn btn-success d-none" id="saveBtn">💾 Save</button>
      <a href="/vendor/profile" class="btn btn-secondary">⬅️ Cancel</a>
    </div>
  </form>
</div>

<!-- JS -->
<script>
  document.getElementById("editBtn").addEventListener("click", function () {
    const form = document.getElementById("profileForm");
    form.querySelectorAll("input, textarea").forEach(input => input.disabled = false);
    document.getElementById("saveBtn").classList.remove("d-none");
    this.classList.add("d-none");
    document.getElementById("photoInput").classList.remove("d-none");
  });

  // Preview selected images
  document.querySelector("input[name='photos']").addEventListener("change", function (event) {
    const preview = document.getElementById("photoPreview");
    preview.innerHTML = "";
    Array.from(event.target.files).forEach(file => {
      const reader = new FileReader();
      reader.onload = e => {
        const img = document.createElement("img");
        img.src = e.target.result;
        img.className = "img-thumbnail";
        img.style.width = "100px";
        img.style.objectFit = "cover";
        preview.appendChild(img);
      };
      reader.readAsDataURL(file);
    });
  });
</script>

</body>
</html>
